{
  "name": "Weg",
  "tagline": "基于fis3 + nodejs ＋ swig 前端集成打包框架",
  "body": "#weg\r\n\r\n\r\n基于fis3+express+swig的前端和后端集成解决方案工程解决方案。在阅读此文档之前，希望你最好对fis、swig、express 、mysql有一定的了解。\r\n\r\n\r\n## 目录\r\n\r\n* [特点](#特点)\r\n* [快速开始](#快速开始)\r\n* [目录规范](#目录规范)\r\n - [client 目录](#前端)\r\n    - [public 目录](#page-目录)\r\n        - [component 目录](#组件)\r\n        - [static 目录](#css／js／image公共静态资源)\r\n    - [views 目录](#static-目录)\r\n      - [page 目录](#页面模板)\r\n      - [widget 目录](#组件)\r\n    - [server.conf](#serverconf)\r\n - [server 目录](#后端)\r\n    - [controller 目录](#路由)\r\n    - [lib 目录](#组件扩展)\r\n    - [middleware 目录](#中间件)\r\n    - [model 目录](＃数据模型)\r\n    - [utils 目录](＃工具类)\r\n - [fis-conf.js](#fis配置文件)\r\n - [server.js](#express启动入口)\r\n\r\n## 特点\r\n\r\n* 基于原生fis前端集成方案对前端资源进行打包，相比自定义fis扩展，方便fis组件升级和维护。\r\n* 整合前端和后端，提供一套骨架，并提供基于mysql的运行示例，拿来即可使用，扩展也很方便。\r\n* 模板引擎采用 [swig](http://paularmstrong.github.io/swig/) ，提供易用的 `html`、`head`、`body`、`widget`、`script`、`style` 等扩展标签。基于这些标签后端可以自动完成对页面的性能优化。\r\n* 基于 `widget` 标签，可以轻松实现组件化，同名tpl、 css、js自动关联加载。\r\n\r\n\r\n## 示例截图\r\n\r\n ![image](https://raw.githubusercontent.com/hubcarl/weg-blog/master/client/public/static/images/demo.png)\r\n\r\n\r\n## 快速开始\r\n\r\n如果还没有安装 [node](http://nodejs.org) 请先安装 [node](http://nodejs.org).\r\n\r\n```bash\r\n# 安装 fis 到全局\r\nnpm install -g weg\r\n\r\n# 下载工程.\r\ngit clone https://github.com/hubcarl/weg-blog.git\r\n\r\n\r\n# 进入 weg-blog  目录， release 后就可以预览了。\r\ncd weg-blog\r\n\r\n\r\n#工程运行\r\nweg release -w 文件修改监控\r\nweg release -m  资源文件md5签名 \r\nweg release --optimize --md5 --watch --pack # fis release -omwp\r\nweg release -omwp   o 资源压缩  m 资源文件md5签名  w 文件修改监控   p打包合并\r\nweg server start --timeout 10000  --port 9000   --type node\r\n```\r\n\r\n### page 目录\r\n\r\n所有页面级别的模板文件，放在此目录。此tpl 可以直接在浏览器中预览。比如 page/index.tpl 可以通过 http://127.0.0.1:9000 访问。 需要强调的的是，模板引擎采用的是 [swig](http://paularmstrong.github.io/swig/), 可以采用模板继承机制来实现模板复用。\r\n\r\nlayout.tpl\r\n\r\n```tpl\r\n<!doctype html>\r\n{% html lang=\"en\" framework=\"public/static/js/mod.js\"  %}\r\n    {% head %}\r\n        <meta charset=\"utf-8\">\r\n        <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\r\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n        <meta name=\"description\" content=\"\">\r\n        <meta name=\"author\" content=\"\">\r\n        <link rel=\"icon\" href=\"/static/favicon.ico\">\r\n        <title>{{ title }}</title>\r\n\r\n        {% require \"public/static/css/normalize.css\" %}\r\n        {% require \"public/static/css/bootstrap.css\" %}\r\n        {% require \"public/static/css/app.css\" %}\r\n\r\n\r\n    {% endhead %}\r\n\r\n    {% body %}\r\n\r\n        {% widget \"widget/menu/menu.tpl\" %}\r\n\r\n\r\n            {% block beforecontent %}\r\n            {% endblock %}\r\n\r\n            <div class=\"container\">\r\n                {% block content %}\r\n                {% endblock %}\r\n            </div>\r\n    \r\n        {% block aftercontent %}\r\n        {% endblock %}\r\n    \r\n    {% endbody %}\r\n\r\n{% endhtml %}\r\n\r\n```\r\n\r\nnews/index/index.tpl\r\n\r\n```tpl\r\n{% extends 'page/layout.tpl' %}\r\n\r\n{% block content %}\r\n\r\n<div class=\"container smart-container\">\r\n    <div class=\"row row-offcanvas row-offcanvas-right\">\r\n        <div class=\"col-xs-12 col-sm-9\">\r\n            <ul class=\"smart-artiles\" id=\"articleList\">\r\n                {% for item in list %}\r\n                <li>\r\n                    <div class=\"point\">+{{item.hits}}</div>\r\n                    <div class=\"card\">\r\n                        <h2><a href=\"/detail/{{item.id}}\" target=\"_blank\">{{item.title}}</a></h2>\r\n                        <div>\r\n                            <ul class=\"actions\">\r\n                                <li>\r\n                                    <time class=\"timeago\">{{item.createDate}}</time>\r\n                                </li>\r\n                                <li class=\"tauthor\">\r\n                                    <a href=\"#\" target=\"_blank\" class=\"get\">Sky</a>\r\n                                </li>\r\n                                <li><a href=\"#\" class=\"kblink-8007\">+收藏</a></li>\r\n                            </ul>\r\n                        </div>\r\n                    </div>\r\n                </li>\r\n                {% endfor %}\r\n            </ul>\r\n            <div id=\"pagerBottom\" class=\"smart-pager\"></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n{% require \"client/views/page/news/index/index.js\" %}\r\n\r\n{% script %}\r\n    console.log('>>>>test>>>>>');\r\n    require('client/views/page/news/index/index.js');\r\n{% endscript %}\r\n\r\n\r\n{% endblock %}\r\n\r\n```\r\n\r\n### static 目录\r\n\r\n用来存放所有静态资源文件，css, js, images ,组件等等。如：\r\n\r\n```\r\n├── css\r\n│   ├── bootstrap-theme.css\r\n│   ├── bootstrap.css\r\n│   └── style.css\r\n└── js\r\n    ├── bootstrap.js\r\n    └── mod.js\r\n```\r\n\r\n### widget 目录\r\n\r\n用来存放各类组件代码。组件分成3类。\r\n\r\n1. 模板类：包含 tpl, 可以选择性的添加 js 和 css 文件，同名的 js 和 css 会被自动加载。\r\n\r\n  模板类文件，可以在模板中通过 widget 标签引用。如\r\n\r\n  ```tpl\r\n  {% widget \"widget/menu/menu.tpl\" %}\r\n  ```\r\n2. js 类： 主要包含 js 文件，放在此目录下的文件一般都会自动被 amd define 包裹，可选择性的添加同名 css 文件，会自动被引用。\r\n\r\n  此类组件，可以在 tpl 或者 js 中通过 require 标签引用。\r\n\r\n  ```tpl\r\n  \r\n    {% require \"client/views/page/news/index/index.js\" %}\r\n\r\n    {% script %}\r\n        console.log('>>>>test>>>>>');\r\n        require('client/views/page/news/index/index.js');\r\n    {% endscript %}\r\n\r\n  ```\r\n3. 纯 css 类：只是包含 css 文件。比如 compass. 同样也是可以通过 require 标签引用。\r\n\r\n### bigpipe\r\n\r\n采用 bigpipe 方案，允许你在渲染页面的时候，提前将框架输出，后续再把耗时的 pagelet 通过 chunk 方式输出到页面，以加速网页渲染。\r\n\r\n- sync 默认就是此模式，直接输出。\r\n- quicking 此类 widget 在输出时，只会输出个壳子，内容由用户自行决定通过 js，另起请求完成填充，包括静态资源加载。\r\n- async 此类 widget 在输出时，也只会输出个壳子，但是内容在 body 输出完后，chunk 输出 js 自动填充。widget 将忽略顺序，谁先准备好，谁先输出。\r\n- pipeline 与 async 基本相同，只是它会严格按顺序输出。\r\n\r\n  {% widget \"widget/header/header.html\" mode=\"pipeline\" id=\"header\" %}\r\n\r\n- 要让 bigpipe 正常运行，需要前端引入 bigpipe.js, 另外 pagelet 为 quickling 模式，是不会自动加载的，需要用户主动去调用 BigPipe.load 方法，才会加载并渲染\r\n\r\n### fis-conf.js \r\n\r\n编译配置文件，详情请查看[配置 API](http://fis.baidu.com/docs/api/fis-conf.html)。\r\n\r\nhttp://www.tuicool.com/articles/6jueiib",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}